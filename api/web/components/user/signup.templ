package user

import (
	"ivixlabs.com/goweb/internal/user/registration"
	"ivixlabs.com/goweb/api/web/components"
	"ivixlabs.com/goweb/internal/validation/form"
)

templ Signup(form *registration.Form, formErrors *form.Errors) {
	if components.App(ctx).IsHxRequest() {
		@signupForm(form, formErrors)
	} else {
		@components.Layout() {
			@signupForm(form, formErrors)
		}
	}
}

templ signupForm(form *registration.Form, formErrors *form.Errors) {
	<form hx-post="/signup" hx-swap="outerHTML" _="on submit toggle @disabled on #formFields">
		<fieldset id="formFields">
			<div class="mb-3">
				<label for="inputEmail4" class="form-label">Email</label>
				<input
					type="text"
					value={ form.Email }
					class={ components.GetClass(formErrors.IsError("Email")) }
					name="email"
					id="inputEmail4"
				/>
				@templ.Raw(components.GetErrorMessage(formErrors, "Email"))
			</div>
			<div class="mb-3">
				<label for="inputUserPassword" class="form-label">Password</label>
				<input
					type="text"
					value={ form.Password }
					class={ components.GetClass(formErrors.IsError("Password")) }
					name="password"
					id="inputUserPassword"
				/>
				@templ.Raw(components.GetErrorMessage(formErrors, "Password"))
			</div>
			<div class="mb-3">
				<label for="inputUserAddress" class="form-label">Address</label>
				<input
					type="text"
					value={ form.Address }
					class={ components.GetClass(formErrors.IsError("Address")) }
					name="address"
					id="inputUserAddress"
				/>
				@templ.Raw(components.GetErrorMessage(formErrors, "Address"))
			</div>
			<button type="submit" class="btn btn-primary">
				<span class="app-indicator">
					<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
				</span>
				Sign up
			</button>
		</fieldset>
	</form>
}
